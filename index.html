// Script Coded By @jisanx << -- Telegram

// Create style for animation dynamically
let style = document.createElement("style");
style.innerHTML = `
@keyframes fadeScaleIn {
  0% {
    opacity: 0;
    transform: translate(-50%, -50%) scale(0.8);
  }
  100% {
    opacity: 1;
    transform: translate(-50%, -50%) scale(1);
  }
}
#transactionFormContainer {
  animation: fadeScaleIn 0.4s ease-out forwards;
}
`;
document.head.appendChild(style);

// Create form container
let formContainer = document.createElement("div");
formContainer.id = "transactionFormContainer";
formContainer.style.position = "fixed";
formContainer.style.top = "50%";
formContainer.style.left = "50%";
formContainer.style.transform = "translate(-50%, -50%) scale(0.8)";
formContainer.style.opacity = "0";
formContainer.style.background = "#f9fafb";
formContainer.style.padding = "25px";
formContainer.style.boxShadow = "0 10px 30px rgba(0,0,0,0.3)";
formContainer.style.zIndex = "9999";
formContainer.style.borderRadius = "12px";
formContainer.style.fontFamily = "Arial, sans-serif";
formContainer.style.minWidth = "320px";

// Title
let title = document.createElement("h3");
title.innerText = "Enter Transaction Details";
title.style.marginTop = "0";
title.style.textAlign = "center";
title.style.color = "#111827";
formContainer.appendChild(title);

// Helper function to create input group with label
function createInput(labelText, id, type, value, placeholder) {
  let label = document.createElement("label");
  label.style.display = "block";
  label.style.marginTop = "10px";
  label.style.color = "#374151";
  label.style.fontWeight = "600";
  label.innerText = labelText;

  let input = document.createElement("input");
  input.type = type;
  input.id = id;
  input.value = value || "";
  input.placeholder = placeholder || "";
  input.style.width = "100%";
  input.style.padding = "8px";
  input.style.border = "1px solid #d1d5db";
  input.style.borderRadius = "6px";
  input.style.marginTop = "6px";
  input.style.fontSize = "14px";
  input.style.boxSizing = "border-box";

  label.appendChild(input);
  return label;
}

// Create Select box helper
function createSelect(labelText, id, optionsArr) {
  let label = document.createElement("label");
  label.style.display = "block";
  label.style.marginTop = "10px";
  label.style.color = "#374151";
  label.style.fontWeight = "600";
  label.innerText = labelText;

  let select = document.createElement("select");
  select.id = id;
  select.style.width = "100%";
  select.style.padding = "8px";
  select.style.border = "1px solid #d1d5db";
  select.style.borderRadius = "6px";
  select.style.marginTop = "6px";
  select.style.fontSize = "14px";
  select.style.boxSizing = "border-box";

  optionsArr.forEach(opt => {
    let option = document.createElement("option");
    option.value = opt.value;
    option.textContent = opt.label;
    select.appendChild(option);
  });

  label.appendChild(select);
  return label;
}

// Append inputs

formContainer.appendChild(createInput("Transaction ID:", "trans_id_input", "text", "", "Enter transaction ID"));
formContainer.appendChild(createInput("Date:", "date_input", "date"));
formContainer.appendChild(createInput("Time:", "time_input", "time"));
formContainer.appendChild(createSelect("Method:", "method_input", [
  { value: "Binance Pay", label: "Binance Pay" },
]));
formContainer.appendChild(createInput("Amount:", "amount_input", "number", "100", "Enter amount"));

// Buttons
let btnContainer = document.createElement("div");
btnContainer.style.textAlign = "center";
btnContainer.style.marginTop = "15px";

let applyBtn = document.createElement("button");
applyBtn.innerText = "Apply";
applyBtn.style.padding = "10px 20px";
applyBtn.style.background = "#10b981";
applyBtn.style.color = "#fff";
applyBtn.style.border = "none";
applyBtn.style.borderRadius = "6px";
applyBtn.style.cursor = "pointer";
applyBtn.style.fontWeight = "600";
applyBtn.style.fontSize = "15px";
applyBtn.style.transition = "background 0.3s ease";
applyBtn.onmouseenter = () => applyBtn.style.background = "#059669";
applyBtn.onmouseleave = () => applyBtn.style.background = "#10b981";

let cancelBtn = document.createElement("button");
cancelBtn.innerText = "Cancel";
cancelBtn.style.padding = "10px 20px";
cancelBtn.style.background = "#ef4444";
cancelBtn.style.color = "#fff";
cancelBtn.style.border = "none";
cancelBtn.style.borderRadius = "6px";
cancelBtn.style.cursor = "pointer";
cancelBtn.style.marginLeft = "10px";
cancelBtn.style.fontWeight = "600";
cancelBtn.style.fontSize = "15px";
cancelBtn.style.transition = "background 0.3s ease";
cancelBtn.onmouseenter = () => cancelBtn.style.background = "#dc2626";
cancelBtn.onmouseleave = () => cancelBtn.style.background = "#ef4444";

btnContainer.appendChild(applyBtn);
btnContainer.appendChild(cancelBtn);
formContainer.appendChild(btnContainer);

document.body.appendChild(formContainer);

// Actions
applyBtn.onclick = function() {
  let trans_id = document.getElementById("trans_id_input").value.trim();
  let date = document.getElementById("date_input").value;
  let time = document.getElementById("time_input").value;
  let method = document.getElementById("method_input").value;
  let amount = document.getElementById("amount_input").value;

  if(!trans_id) {
    alert("Please enter Transaction ID.");
    return;
  }
  if(!date) {
    alert("Please select a Date.");
    return;
  }
  if(!time) {
    alert("Please select a Time.");
    return;
  }
  if(!amount || amount <= 0) {
    alert("Please enter a valid Amount.");
    return;
  }

  let formattedDateTime = "";
  try {
    let dt = new Date(date + "T" + time);
    let dd = String(dt.getDate()).padStart(2, '0');
    let mm = String(dt.getMonth() + 1).padStart(2, '0');
    let yyyy = dt.getFullYear();
    let hh = String(dt.getHours()).padStart(2, '0');
    let min = String(dt.getMinutes()).padStart(2, '0');
    let sec = String(dt.getSeconds()).padStart(2, '0');
    formattedDateTime = `${dd}/${mm}/${yyyy}, ${hh}:${min}:${sec}`;
  } catch (e) {
    formattedDateTime = `${date}, ${time}`;
  }

  let message = `The withdrawal is currently being processed on the side of the financial operator. Please wait - the funds should be received within 48 hours.`;

  let position = 0;
  let items = document.getElementsByClassName("transactions-item");
  if (items.length > 0) {
    items[position].innerHTML =
      '<div class="transactions-item__id">' + trans_id +
      '</div><div class="transactions-item__date">' + formattedDateTime +
      '</div><div class="transactions-item__status"><div class="transactions-item__status-processed">' + message +
      '</div><div class="transactions-item__status-block"><div class="transactions-item__status-icon muted"><svg class="icon-pending"><use xlink:href="/profile/images/spritemap.svg#icon-pending"></use></svg></div><span class="transactions-item__status-text pending">waiting confirmation</span></div></div><div class="transactions-item__type">Payout</div><div class="transactions-item__method">' + method +
      '</div><b class="transactions-item__amount red">-' + '$' + amount + '.00</b>';
  } else {
    alert("No .transactions-item element found on this page.");
  }

  document.body.removeChild(formContainer);
};

cancelBtn.onclick = function() {
  document.body.removeChild(formContainer);
};
